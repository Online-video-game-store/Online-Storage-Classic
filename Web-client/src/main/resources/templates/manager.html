<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Products</title>
    <link rel="stylesheet" th:href="@{/css/heder.css}">
    <link rel="stylesheet" th:href="@{/css/left-panel.css}">
    <link rel="stylesheet" th:href="@{/css/product.css}">
    <link rel="stylesheet" th:href="@{/css/pagination.css}">
    <link rel="stylesheet" th:href="@{/css/manager.css}">
    <script th:src="@{/js/manager.js}"></script>
</head>

<body>

<div class="header">
    <div class="page-title">–ò–≥—Ä—ã –¥–ª—è –ü–ö8000</div>
    <div class="user-info">
        <div>
            <span th:text="'–ü—Ä–∏–≤–µ—Ç, ' + ${username} + '!'">–ü—Ä–∏–≤–µ—Ç, –ì–æ—Å—Ç—å!</span>
            <a th:href="@{/pk8000/catalog/index}" class="logout-button">–í—ã—Ö–æ–¥</a>
        </div>
    </div>
</div>

<div class="container">
    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ -->
    <div class="sidebar">
        <div class="categories">
            <div th:each="category : ${categories}"
                 class="category-button"
                 th:classappend="${category.name == currentCategory} ? 'active-category' : ''"
                 th:data-category-id="${category.id}"
                 onclick="redirectToCategory(this)">
                <span th:text="${category.name}"></span>
            </div>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div class="filter">
            <h3>–§–∏–ª—å—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤</h3>
            <input type="text" th:value="${productName}" id="productName" placeholder="–ò–º—è —Ç–æ–≤–∞—Ä–∞" class="filter-input">
            <input type="number" th:value="${minPrice}" id="minPrice" placeholder="–ú–∏–Ω. —Ü–µ–Ω–∞" min="0" class="filter-input">
            <input type="number" th:value="${maxPrice}" id="maxPrice" placeholder="–ú–∞–∫—Å. —Ü–µ–Ω–∞" min="0" class="filter-input">
            <button onclick="redirectToCategory()" class="filter-button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤ -->
    <main class="content">
        <table class="product-table">
            <thead>
            <tr>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th style="width: 100px;">–¶–µ–Ω–∞</th>
                <th style="width: 80px;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th style="width: 80px;">–í –Ω–∞–ª–∏—á–∏–∏</th>
                <th style="width: 30%;">–û–ø–∏—Å–∞–Ω–∏–µ</th>
                <th style="width: 180px;">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
                <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="product : ${products}">
                <td><input type="text" th:name="'name_' + ${product.id}" th:value="${product.name}" id="name_${product.id}" /></td>
                <td><input type="number" th:name="'price_' + ${product.id}" step="0.01" th:value="${product.price}" id="price_${product.id}" style="width: 90px;" /></td>
                <td>
                    <select th:id="'category_' + ${product.id}" th:name="'category_' + ${product.id}">
                        <option th:each="cat : ${categories}"
                                th:if="${cat.id != 0}"
                                th:value="${cat.id}"
                                th:text="${cat.name}"
                                th:selected="${cat.id == product.category}">
                        </option>
                    </select>
                </td>
                <td><input type="number" th:name="'stock_' + ${product.id}" th:value="${product.stock}" id="stock_${product.id}" style="width: 70px;" /></td>
                <td><textarea th:name="'description_' + ${product.id}" th:text="${product.description}" id="description_${product.id}" style="width: 100%; height: 60px;"></textarea></td>
                <td>
                    <button type="button" th:onclick="'openImageModal(' + ${product.id} + ')'" class="btn-image-manage">üì∑ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
                </td>
                <td>
                    <!-- –ö–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è, –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ JS (–∏–ª–∏ —É–¥–∞–ª—è—Ç—å) -->
                    <button type="button" th:onclick="'saveProduct(' + ${product.id} + ')'" >üíæ</button>
                    <button type="button" th:onclick="'deleteProduct(' + ${product.id} + ')'" >üóëÔ∏è</button>
                </td>
            </tr>
            <!-- —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ -->
            <tr>
                <td><input type="text" id="new_name" /></td>
                <td><input type="number" step="0.01" id="new_price" style="width: 90px;" /></td>
                <td>
                    <select id="new_category">
                        <option th:each="cat : ${categories}"
                                th:if="${cat.id != 0}"
                                th:value="${cat.id}"
                                th:text="${cat.name}">
                        </option>
                    </select>
                </td>
                <td><input type="number" id="new_stock" style="width: 70px;" /></td>
                <td><textarea id="new_description" style="width: 100%; height: 60px;"></textarea></td>
                <td>‚Äî</td>
                <td>
                    <button type="button" onclick="addNewProduct()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                </td>
            </tr>
            </tbody>
        </table>
    </main>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ -->
<div id="imageModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</h2>
        <div id="imageList" style="display: flex; flex-wrap: wrap;"></div>
        <input type="file" id="fileInput" class="hidden-file-input" />
    </div>
</div>


<div class="pagination-container">
    <!-- –ü–∞–≥–∏–Ω–∞—Ç–æ—Ä. –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫. —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ —Ñ–∏–ª—å—Ç—Ä–∞, –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è —Ñ–æ—Ä–º -->
    <div class="pagination" th:with="startPage=${currentPage > 5 ? currentPage - 5 : 0},
                                     endPage=${totalPages > currentPage + 5 ? currentPage + 5 : totalPages - 1}">
        <ul>
            <!-- –ö–Ω–æ–ø–∫–∞ "Previous" -->
            <li th:if="${currentPage > 0}">
                <form th:action="@{/pk8000/catalog/index/setup}" method="get" style="display: inline;">
                    <input type="hidden" name="elemsOfPage" th:value="${elemsOfPage}">
                    <input type="hidden" name="pageNo" th:value="${currentPage - 1}">
                    <input type="hidden" name="categoryId" th:value="${categoryId}">
                    <button type="submit" class="pagination-button">Previous</button>
                </form>
            </li>

            <!-- –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü -->
            <li th:each="i : ${#numbers.sequence(startPage, endPage)}">
                <form th:action="@{/pk8000/catalog/index/setup}" method="get" style="display: inline;">
                    <input type="hidden" name="elemsOfPage" th:value="${elemsOfPage}">
                    <input type="hidden" name="pageNo" th:value="${i}">
                    <input type="hidden" name="categoryId" th:value="${categoryId}">
                    <button type="submit"
                            class="pagination-button"
                            th:classappend="${currentPage == i} ? 'active' : ''"
                            th:text="${i + 1}">
                    </button>
                </form>
            </li>

            <!-- –ö–Ω–æ–ø–∫–∞ "Next" -->
            <li th:if="${currentPage < totalPages - 1}">
                <form th:action="@{/pk8000/catalog/index/setup}" method="get" style="display: inline;">
                    <input type="hidden" name="elemsOfPage" th:value="${elemsOfPage}">
                    <input type="hidden" name="pageNo" th:value="${currentPage + 1}">
                    <input type="hidden" name="categoryId" th:value="${categoryId}">
                    <button type="submit" class="pagination-button">Next</button>
                </form>
            </li>
        </ul>
    </div>
</div>

</body>
</html>
